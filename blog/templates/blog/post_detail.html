{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>{{ post.title }} | Post Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">
    <h3>{{ post.title }}</h3>
    <p class="text-muted">
        Posted by {{ post.author.username }} on {{ post.created_at }}
    </p>

    <p>{{ post.content }}</p>

    <!-- LIKE BUTTON -->
    <form method="POST" action="{% url 'like_post' post.id %}" class="mb-3">
        {% csrf_token %}
        <button class="btn btn-sm btn-primary" type="submit">
            {% if user_liked %}Unlike{% else %}Like{% endif %} ({{ like_count }})
        </button>
    </form>

    <hr>
    <h5>Comments</h5>

    <!-- EXISTING COMMENTS -->
    {% for comment in comments %}
        <div class="card p-2 mb-2">
            <p><strong>{{ comment.user.username }}:</strong> {{ comment.content }}</p>
            <small class="text-muted">{{ comment.created_at }}</small>
        </div>
    {% empty %}
        <p class="text-muted">No comments yet.</p>
    {% endfor %}

    <!-- ADD COMMENT FORM -->
    {% if user.is_authenticated %}
        <form method="POST" action="{% url 'add_comment' post.id %}" class="mt-3">
            {% csrf_token %}
            <textarea name="content" class="form-control mb-2" placeholder="Write a comment..." required></textarea>
            <button class="btn btn-success">Add Comment</button>
        </form>
    {% else %}
        <p class="text-muted mt-3">Login to comment.</p>
    {% endif %}
</div>

</body>
</html>
